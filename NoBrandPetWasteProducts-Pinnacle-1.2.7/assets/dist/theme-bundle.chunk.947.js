"use strict";(self.webpackChunkPinnacle=self.webpackChunkPinnacle||[]).push([[947],{947:(t,e,r)=>{r.r(e),r.d(e,{default:()=>v}),r(2310),r(8838),r(110),r(6253),r(6059),r(5767),r(522),r(9115),r(6997),r(1181);var n=r(2066),a=r(469),o=r(5825),i=r.n(o),s=r(8426),c=r(4587),d=(r(6142),r(1876),r(8575));const u=function(t){window.history.pushState({},document.title,t),i()(window).trigger("statechange")},l=function(t,e){var r,n=d.parse(t,!0);for(r in n.search=null,e)e.hasOwnProperty(r)&&(n.query[r]=e[r]);return d.format(n)};var h=r(8350),f=(r(1647),r(97));function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}var v=function(t){var e,r;function a(){return t.apply(this,arguments)||this}r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,g(e,r);var o=a.prototype;return o.formatCategoryTreeForJSTree=function(t){var e=this,r={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(r.state.opened="open"===t.state,r.children=!0),t.children&&(r.children=[],t.children.forEach((function(t){r.children.push(e.formatCategoryTreeForJSTree(t))}))),r},o.showProducts=function(t){if(void 0===t&&(t=!0),this.$productListingContainer.removeClass("u-hiddenVisually"),this.$facetedSearchContainer.removeClass("u-hiddenVisually"),this.$contentResultsContainer.addClass("u-hiddenVisually"),i()("[data-content-results-toggle]").removeClass("navBar-action-color--active"),i()("[data-content-results-toggle]").addClass("navBar-action"),i()("[data-product-results-toggle]").removeClass("navBar-action"),i()("[data-product-results-toggle]").addClass("navBar-action-color--active"),t){var e=i()("#search-results-product-count span").data(),r=e.count>0?e.url:l(e.url,{page:1});u(r)}},o.showContent=function(t){if(void 0===t&&(t=!0),this.$contentResultsContainer.removeClass("u-hiddenVisually"),this.$productListingContainer.addClass("u-hiddenVisually"),this.$facetedSearchContainer.addClass("u-hiddenVisually"),i()("[data-product-results-toggle]").removeClass("navBar-action-color--active"),i()("[data-product-results-toggle]").addClass("navBar-action"),i()("[data-content-results-toggle]").removeClass("navBar-action"),i()("[data-content-results-toggle]").addClass("navBar-action-color--active"),t){var e=i()("#search-results-content-count span").data(),r=e.count>0?e.url:l(e.url,{page:1});u(r)}},o.onReady=function(){var t=this;(0,c.Z)(this.context.urls);var e=i()("[data-advanced-search-form]"),r=e.find("[data-search-category-tree]"),a=d.parse(window.location.href,!0),o=[];this.$productListingContainer=i()("#product-listing-container"),this.$facetedSearchContainer=i()("#faceted-search-container"),this.$contentResultsContainer=i()("#search-results-content"),i()("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),n.PT.on("sortBy-submitted",this.onSortBySubmit)),(0,h.ZP)(),i()("[data-product-results-toggle]").on("click",(function(e){e.preventDefault(),t.showProducts()})),i()("[data-content-results-toggle]").on("click",(function(e){e.preventDefault(),t.showContent()})),0===this.$productListingContainer.find("li.product").length||"content"===a.query.section?this.showContent(!1):this.showProducts(!1);var s=this.initValidation(e).bindValidation(e.find("#search_query_adv"));this.context.categoryTree.forEach((function(e){o.push(t.formatCategoryTreeForJSTree(e))})),this.categoryTreeData=o,this.createCategoryTree(r),e.on("submit",(function(t){var n=r.jstree().get_selected();if(!s.check())return t.preventDefault();e.find('input[name="category[]"]').remove();for(var a,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(a=o()).done;){var c=a.value,d=i()("<input>",{type:"hidden",name:"category[]",value:c});e.append(d)}}))},o.loadTreeNodes=function(t,e){var r=this;i().ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:t.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var n=[];t.forEach((function(t){n.push(r.formatCategoryTreeForJSTree(t))})),e(n)}))},o.createCategoryTree=function(t){var e=this,r={core:{data:function(t,r){"#"===t.id?r(e.categoryTreeData):e.loadTreeNodes(t,r)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(r)},o.initFacetedSearch=function(){var t=this,e=i()("#product-listing-container"),r=i()("#search-results-content"),n=i()("#faceted-search-container"),a=i()("#search-results-heading"),o=i()("#search-results-product-count"),c=i()("#search-results-content-count"),u={template:{productListing:"search/product-listing",contentListing:"search/content-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count",contentCount:"search/content-count"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new s.Z(u,(function(s){a.html(s.heading),"content"===d.parse(window.location.href,!0).query.section?(r.html(s.contentListing),c.html(s.contentCount),t.showContent(!1)):(e.html(s.productListing),n.html(s.sidebar),o.html(s.productCount),t.showProducts(!1)),i()("body").triggerHandler("compareReset"),i()("html, body").animate({scrollTop:0},100)}))},o.initValidation=function(t){return this.$form=t,this.validator=(0,f.Z)({submit:t}),this},o.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},o.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},a}(a.Z)}}]);
//# sourceMappingURL=theme-bundle.chunk.947.js.map